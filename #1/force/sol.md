### 暴力出奇迹
#### 算法一
当然是模拟。每次A操作把所有数都加上val，Q操作O(n)查询。
时间复杂度
期望得分：50pts

##### 优化
每次A操作时，打个整体标记， 完成。
期望得分：$\ge$50pts ，实际得分：100pts （参考题目名称）

#### 算法二
考虑当前所有数都被加了x，那么一个子段的权值可以表示为$y=kx+b$的一次函数的形式。其中，k为序列长度，b为序列原来的和。求最大子段和就是对于一个x，求所有函数中最大的y。
对于同一个k，显然只要找到最大的b就可以。这样可以得到n个一次函数。然后对这n个函数维护一个上凸包。由于x是单调不减的，所以用一个单调队列维护就可以。于是想到了分块。在块内用上面的方法求出最大子段和、包含左端点的最大子段和、包含右端点的最大子段和。询问时合并，多余部分暴力。
时间复杂度 ，期望得分：100pts